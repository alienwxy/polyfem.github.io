



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="A polyvalent C++ FEM library">
      
      
        <link rel="canonical" href="http://polyfem.github.io/polyfem/tutorial/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.1.0">
    
    
      
        <title>Tutorial - polyfem</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.11e41852.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#7cb342">
      
    
    
      <script src="../assets/javascripts/modernizr.20ef595d.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="light-green" data-md-color-accent="green">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#tutorial" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="http://polyfem.github.io/polyfem/" title="polyfem" class="md-header-nav__button md-logo">
          
            <i class="md-icon"> </i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                polyfem
              </span>
              <span class="md-header-nav__topic">
                Tutorial
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/polyfem/polyfem/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      polyfem/polyfem
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="http://polyfem.github.io/polyfem/" title="polyfem" class="md-nav__button md-logo">
      
        <i class="md-icon"> </i>
      
    </a>
    polyfem
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/polyfem/polyfem/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      polyfem/polyfem
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Tutorial
      </label>
    
    <a href="./" title="Tutorial" class="md-nav__link md-nav__link--active">
      Tutorial
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ui" title="UI" class="md-nav__link">
    UI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#json" title="JSON" class="md-nav__link">
    JSON
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#boundary-conditions" title="Boundary Conditions" class="md-nav__link">
    Boundary Conditions
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../documentation/" title="Documentation" class="md-nav__link">
      Documentation
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ui" title="UI" class="md-nav__link">
    UI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#json" title="JSON" class="md-nav__link">
    JSON
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#boundary-conditions" title="Boundary Conditions" class="md-nav__link">
    Boundary Conditions
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/polyfem/polyfem.github.io/edit/docs/docs/tutorial.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="tutorial">Tutorial<a class="headerlink" href="#tutorial" title="Permanent link">&para;</a></h1>
<p><a href="../img/plane_hole.obj">Here</a> you can find the <em>plate with hole</em> mesh used in this tutorial.</p>
<h2 id="ui">UI<a class="headerlink" href="#ui" title="Permanent link">&para;</a></h2>
<p>Start the program with <code class="codehilite">PolyFEM_bin</code> this will open the UI.
Press the the load button to load a mesh
<img alt="Load mesh" src="../img/t1.png" /></p>
<p>Then press the numbered button in sequence:</p>
<ol>
<li>Loads the mesh and normalized it</li>
<li>Builds the FEM bases, you can change the order by changing discr. To enable <em>pref</em> or <em>spline</em> check the corresponding boxes (before pushing the button)</li>
<li>Build a denser mesh for visualization purposes.</li>
<li>Assembles the right-hand side of the problem. You can change the problem with the problem drop-down menu</li>
<li>Assembles the matrix. You can change the formulation by changing the drop-down 1D nD form. The type of formulation depends on the problem. For instance Franke works only with scalar formulations, while Elastic only with tensor problems.</li>
<li>Solve problem solves the problem.</li>
<li>You can compute the error for problems with given exact solutions. In case of no exact solution, the program will compute the norms of the solutions
<img alt="Load mesh" src="../img/t2.png" /></li>
</ol>
<p>At the end you can press save VTU to save the <code class="codehilite">result.vtu</code> file in the binary directory. This file can be opened with <a href="https://www.paraview.org/">Paraview</a></p>
<p><img alt="Load mesh" src="../img/t3.png" /></p>
<h2 id="json">JSON<a class="headerlink" href="#json" title="Permanent link">&para;</a></h2>
<p>To run the previous experiment with a json file create a <code class="codehilite">run.json</code> containing (refer to <a href="../documentation/">documentation</a> for the full description):</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;mesh&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;mesh.obj&gt;&quot;</span><span class="p">,</span>
    <span class="nt">&quot;normalize_mesh&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>

    <span class="nt">&quot;n_refs&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>

    <span class="nt">&quot;scalar_formulation&quot;</span><span class="p">:</span> <span class="s2">&quot;Laplacian&quot;</span><span class="p">,</span>

    <span class="nt">&quot;discr_order&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nt">&quot;use_spline&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nt">&quot;use_p_ref&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>

    <span class="nt">&quot;output&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;stats.json&gt;&quot;</span><span class="p">,</span>

    <span class="nt">&quot;problem&quot;</span><span class="p">:</span> <span class="s2">&quot;Franke&quot;</span><span class="p">,</span>

    <span class="nt">&quot;export&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;vis_mesh&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;result.vtu&gt;&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>Then run <code class="codehilite">PolyFEM_bin --json run.json --cmd</code>. You can omit the <code class="codehilite">--cmd</code> argument to open the UI with the parameters.</p>
<h2 id="boundary-conditions">Boundary Conditions<a class="headerlink" href="#boundary-conditions" title="Permanent link">&para;</a></h2>
<p>For more advanced problems such as <code class="codehilite">GenericTensor</code>, <code class="codehilite">TorsionElastic</code>, or <code class="codehilite">DrivenCavity</code> the boundary conditions might be different for each boundary. For instance for the <code class="codehilite">TorsionElastic</code> problem you need to specify which part is fixed and which part moves. PolyFEM uses boundary tags to mark boundary primitives (edges in 2D and faces in 3D). By default:</p>
<ul>
<li>in 2D all edges which barycenter is close up to 1e-7 to the left side of the bounding box gets tag 1, the right side gets 3, bottom 2, and top 4. Any other boundary gets 7.</li>
<li>in 3D the threshold is a bit larger (1e-2) and x-direction gets 1, 3, y-direction gets 2, 4, and z-direction gets 5, 6. Any other boundary gets 7.</li>
</ul>
<p>You can also specify a file containing a list of integers per each edge/face of the mesh indicating the tag in the json value <code class="codehilite">bc_tag</code>.</p>
<p>If you want to run the <em>real</em> plate with hole problem you need to choose <code class="codehilite">GenericTensor</code> as problem, set the correct Lame constants in <code class="codehilite">params</code>, and specify the proper boundary conditions in <code class="codehilite">problem_params</code>. For this example we want Neumann boundary condition of [100, 0]  (a force of 100 in x) applied to the whole right side (pulling), so in the <code class="codehilite">neumann_boundary</code> array of <code class="codehilite">problem_params</code> we add en entry with <code class="codehilite">id</code> 3 and value [100, 0].
For the 2 Dirichlet is a bit more complicated because we want reflective boundary condition, that is we want to fix only one of the 2 coordinates. For instance, the right part of the mesh (id 1) needs to be fixed in x (or equivalent can move only in y-direction). To do so we add an entry to the <code class="codehilite">dirichlet_boundary</code> array with <code class="codehilite">id</code> 1 and <code class="codehilite">value</code> [0, 0], that is zero displacement, and specify which <code class="codehilite">dimension</code> these boundaries needs to be applied, in this case only the x-direction so <code class="codehilite">dimension</code> gets the value <code class="codehilite">[true, false]</code>. Similarly the top part (id 4) gets <code class="codehilite">dimension=[false, true]</code>.</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="err">...</span>

    <span class="nt">&quot;problem&quot;</span><span class="p">:</span> <span class="s2">&quot;GenericTensor&quot;</span><span class="p">,</span>

    <span class="nt">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;E&quot;</span><span class="p">:</span> <span class="mi">210000</span><span class="p">,</span>
        <span class="nt">&quot;nu&quot;</span><span class="p">:</span> <span class="mf">0.3</span>
    <span class="p">},</span>

    <span class="nt">&quot;problem_params&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;neumann_boundary&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                <span class="nt">&quot;value&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="mi">100</span><span class="p">,</span>
                    <span class="mi">0</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">],</span>

        <span class="nt">&quot;dirichlet_boundary&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="nt">&quot;dimension&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="kc">true</span><span class="p">,</span>
                    <span class="kc">false</span>
                <span class="p">],</span>
                <span class="nt">&quot;value&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="mf">0.0</span><span class="p">,</span>
                    <span class="mf">0.0</span>
                <span class="p">]</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
                <span class="nt">&quot;dimension&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="kc">false</span><span class="p">,</span>
                    <span class="kc">true</span>
                <span class="p">],</span>
                <span class="nt">&quot;value&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="mf">0.0</span><span class="p">,</span>
                    <span class="mf">0.0</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
</pre></div>

<p>Note that as value you can also specify an expression as string depending on x,y,z and PolyFEM will evaluate that expression on the edge/face.</p>
<p>Since creating the file with association from boundary to id it is complicated, we also provide an application <code class="codehilite">bc_setter</code> to interactively <em>color</em> faces of 3D meshes (or edges of 2D meshes) and associate tags. By <em>shift</em> clicking you can color coplanar faces to assign and id (<em>command</em> or <em>control</em> click colors only one face). The UI also allow to specify the 3 values (for scalar problem only one) to assign to that boundary condition and choose between Dirichelt and Neumann. On save it will produce the txt file with the tags to be used in <code class="codehilite">bc_tag</code> and a json file to set the <code class="codehilite">problem_params</code>. Note, if you selected the vector problem you need to use <code class="codehilite">&quot;problem&quot;: &quot;GenericTensor&quot;</code> otherwise <code class="codehilite">&quot;problem&quot;: &quot;GenericScalar&quot;</code>.</p>
<p><img alt="bc_setter" src="../img/bc_setter.png" /></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href=".." title="Home" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Home
              </span>
            </div>
          </a>
        
        
          <a href="../documentation/" title="Documentation" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Documentation
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/polyfem" class="md-footer-social__link fa fa-github"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.9e1f3b71.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
    
      
    
  </body>
</html>